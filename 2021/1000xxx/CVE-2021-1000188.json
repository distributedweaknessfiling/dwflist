{
  "dwf": {
    "vendor_name": "Hashicorp",
    "product_name": "Terraform",
    "product_version": "0.15.3",
    "vulnerability_type": "default search paths use Terraform Registry for custom providers",
    "affected_component": "terraform plan",
    "attack_vector": "code processed by the CI/CD pipeline using \"terraform plan\"",
    "impact": "Remote code Execution, exfiltration of environmental variables, etc.",
    "credit": "alxk serain",
    "references": [
      "https://alex.kaskaso.li/post/terraform-plan-rce",
      "https://www.reddit.com/r/netsec/comments/nbj5m7/terraform_plan_rce/",
      "https://www.terraform.io/docs/language/modules/sources.html"
    ],
    "reporter": "kurtseifried",
    "reporter_id": 582211,
    "notes": "It appears that there is no way to control access to various registries in terraform configuration files beyond external controls such as firewalling. ",
    "description": "In Hashicorp Terraform version 0.15.3 the default search paths use Terraform Registry for custom providers if they exist in the terraform plan which can be attacked via code processed by the CI/CD pipeline using \"terraform plan\" resulting in Remote code Execution, exfiltration of environmental variables, etc. "
  },
  "data_type": "CVE",
  "data_format": "MITRE",
  "data_version": "4.0",
  "CVE_data_meta": {
    "ASSIGNER": "dwf",
    "ID": "CVE-2021-1000188",
    "STATE": "PUBLIC"
  },
  "affects": {
    "vendor": {
      "vendor_data": [
        {
          "vendor_name": "Hashicorp",
          "product": {
            "product_data": [
              {
                "product_name": "Terraform",
                "version": {
                  "version_data": [
                    {
                      "version_value": "0.15.3"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  },
  "problemtype": {
    "problemtype_data": [
      {
        "description": [
          {
            "lang": "eng",
            "value": "default search paths use Terraform Registry for custom providers"
          }
        ]
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "url": "https://alex.kaskaso.li/post/terraform-plan-rce",
        "refsource": "MISC",
        "name": "https://alex.kaskaso.li/post/terraform-plan-rce"
      },
      {
        "url": "https://www.reddit.com/r/netsec/comments/nbj5m7/terraform_plan_rce/",
        "refsource": "MISC",
        "name": "https://www.reddit.com/r/netsec/comments/nbj5m7/terraform_plan_rce/"
      },
      {
        "url": "https://www.terraform.io/docs/language/modules/sources.html",
        "refsource": "MISC",
        "name": "https://www.terraform.io/docs/language/modules/sources.html"
      }
    ]
  },
  "description": {
    "description_data": [
      {
        "lang": "eng",
        "value": "In Hashicorp Terraform version 0.15.3 the default search paths use Terraform Registry for custom providers if they exist in the terraform plan which can be attacked via code processed by the CI/CD pipeline using \"terraform plan\" resulting in Remote code Execution, exfiltration of environmental variables, etc. "
      }
    ]
  }
}
